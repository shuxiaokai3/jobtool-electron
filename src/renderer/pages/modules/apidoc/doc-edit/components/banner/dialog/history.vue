/*
    创建者：shuxiaokai
    创建时间：2020-06-26 19:07
    模块名称：查看历史记录
    备注：xxxx
*/
<template>
    <div class="history-dailog">
        <el-drawer title="查看历史记录" :visible="visible" direction="rtl" size="60%" :before-close="handleClose">
            <!-- <span v-if="scope.row.docInfo[0].url" class="mr-2">
                <span v-if="scope.row.docInfo[0].method === 'get'" class="green">GET</span>
                <span v-else-if="scope.row.docInfo[0].method === 'post'" class="yellow">POST</span>
                <span v-else-if="scope.row.docInfo[0].method === 'put'" class="blue">PUT</span>
                <span v-else-if="scope.row.docInfo[0].method === 'delete'" class="red">DEL</span>
                <span>{{ scope.row.docInfo[0].url }}</span>                            
            </span> -->
           <!-- 表格展示 -->
           <s-table ref="table" url="/api/docs/docs_history" :index="false" :params="{projectId: $route.query.id}">
                <el-table-column label="操作详情" header-align="center" show-overflow-tooltip min-width="100px">
                   <template slot-scope="scope">
                        <div class="d-flex a-center">
                            <!-- 重命名文档 -->
                            <template v-if="scope.row.operation === 'rename' && scope.row.docInfo[1]">
                                <svg class="svg-icon mr-1">
                                    <use xlink:href="#iconrename"></use>
                                </svg>
                                <del>{{ scope.row.docInfo[0].docName }}</del>
                                <span class="red mx-1 el-icon-right"></span>
                                <span>{{ scope.row.docInfo[1].docName }}</span>
                            </template>
                            <!-- 新建文件 -->
                            <template v-if="scope.row.operation === 'addDoc'">
                                <svg v-if="!scope.row.docInfo[0].isFolder" class="svg-icon mr-1">
                                    <use xlink:href="#iconwenjian"></use>
                                </svg>
                                <span>{{ scope.row.docInfo[0].docName }}</span>
                                <span class="green">++</span>
                            </template>
                            <!-- 新建文件夹 -->
                            <template v-if="scope.row.operation === 'addFolder'">
                                <svg v-if="scope.row.docInfo[0].isFolder" class="svg-icon mr-1">
                                    <use xlink:href="#icon-folder-empty"></use>
                                </svg> 
                                <span>{{ scope.row.docInfo[0].docName }}</span>
                                <span class="green">++</span>
                            </template>
                            <!-- 复制文档 -->
                            <template v-if="scope.row.operation === 'copyDoc'">
                                <span class="svg-icon mr-1 green">cp</span>
                                <span>{{ scope.row.docInfo[0].docName }}</span>
                            </template>
                            <!-- 删除文档 -->
                            <template v-if="scope.row.operation === 'deleteDoc'">
                                <span class="svg-icon mr-1 red iconfont iconshanchuwenjian"></span>
                                <span>{{ scope.row.docInfo[0].docName }}</span>
                                <span class="red">&nbsp;-&nbsp;-</span>
                            </template>
                            <!-- 删除文件夹 -->
                            <template v-if="scope.row.operation === 'deleteFolder'">
                                 <svg v-if="scope.row.docInfo[0].isFolder" class="svg-icon mr-1">
                                    <use xlink:href="#iconshanchuwenjianjia"></use>
                                </svg> 
                                <span>{{ scope.row.docInfo[0].docName }}</span>
                                <span class="red">&nbsp;-&nbsp;-</span>
                            </template>
                        </div>
                   </template>
                </el-table-column>
                <el-table-column label="操作类型" align="center">
                    <template slot-scope="scope">
                        <span v-if="scope.row.operation === 'addDoc'" class="green">新建文件</span>
                        <span v-if="scope.row.operation === 'addFolder'" class="green">新建文件夹</span>
                        <span v-if="scope.row.operation === 'copyDoc'" class="green">复制文档</span>
                        <span v-if="scope.row.operation === 'copyFolder'" class="green">复制文件夹</span>
                        <span v-if="scope.row.operation === 'deleteFolder'" class="red">删除文件夹</span>
                        <span v-if="scope.row.operation === 'deleteDoc'" class="red">删除文档</span>
                        <span v-if="scope.row.operation === 'deleteMany'" class="red">多个删除</span>
                        <span v-if="scope.row.operation === 'editDoc'" class="orange">修改文档内容</span>
                        <span v-if="scope.row.operation === 'position'" class="orange">改变文档位置</span>
                        <span v-if="scope.row.operation === 'rename'" class="orange">重命名文档</span>
                        <span v-if="scope.row.operation === 'import'" class="red">导入文档</span>
                    </template>
                </el-table-column>
                <el-table-column label="操作时间" align="center">
                    <template slot-scope="scope">
                        <span>{{ new Date(scope.row.createdAt).toLocaleString() }}</span>
                    </template>
                </el-table-column>
                <el-table-column label="操作者" align="center" width="100px">
                    <template slot-scope="scope">
                        <span>{{ scope.row.operator }}</span>
                    </template>
                </el-table-column>
                <!-- <el-table-column label="操作" align="center">
                    <template>
                        <el-button type="text">修改</el-button>
                        <el-button type="text">删除</el-button>
                    </template>
                </el-table-column> -->
            </s-table>
            
        </el-drawer>
    </div>
</template>

<script>
export default {
    props: {
        visible: { //是否现实弹窗
            type: Boolean,
            default: true
        },
    },
    data() {
        return {
            //=====================================其他参数====================================//
            loading: false, //----确认按钮状态
        };
    },
    watch: {
        visible() {
            this.$refs["table"] && this.$refs["table"].getData();
        }
    },
    created() {
    },
    methods: {
        //=====================================获取远程数据==================================//

        //=====================================前后端交互====================================//

        //=====================================组件间交互====================================//  
        //=====================================其他操作=====================================//
        //关闭弹窗
        handleClose() {
            this.$emit("update:visible", false);
            this.$emit("close");
        },
    }
};
</script>



<style lang="scss">
.history-dailog {
    .svg-icon {
        width: size(25);
        height: size(25);
        padding: size(5);
        display: inline-flex;
        align-items: center;
        justify-content: center;
        border: 1px solid $gray-300;
        border-radius: 50%;
    }   
}


</style>
